"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var constants_1 = require("./constants");
var versionLoader_1 = require("./versionLoader");
var loader_1 = require("./loader");
var loadedPaymentInstance = null;
function RevolutPaymentsLoader(token, mode, locale) {
    if (mode === void 0) { mode = RevolutPaymentsLoader.mode; }
    if (loadedPaymentInstance) {
        var instance = loadedPaymentInstance({ publicToken: token, locale: locale });
        return Promise.resolve(instance);
    }
    return versionLoader_1.RevolutPaymentsVersionLoader(mode)
        .then(function (version) { return loader_1.loadRevolutCheckout(version, mode, 'RevolutPayments'); })
        .then(function (revolutCheckout) {
        loadedPaymentInstance = revolutCheckout.payments;
        return revolutCheckout.payments({ publicToken: token, locale: locale });
    });
}
exports.RevolutPaymentsLoader = RevolutPaymentsLoader;
RevolutPaymentsLoader.mode = constants_1.MODE.PRODUCTION;
